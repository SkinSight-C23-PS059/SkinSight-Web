<!DOCTYPE html>
<html>
  <head>
    <title>Profile</title>
    <!-- ===== CSS ===== -->
    <link rel="stylesheet" href="css/profil.css" />

    <!-- ===== Boxicons CSS ===== -->
    <link
      href="https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css"
      rel="stylesheet"
    />

    <!-- ===== SweetAlert2 CSS ===== -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <body>
    <nav>
      <div class="nav-bar">
        <i class="bx bx-menu sidebarOpen"></i>
        <span class="logo navLogo"><a href="#">SkinSight</a></span>

        <div class="menu">
          <div class="logo-toggle">
            <span class="logo"><a href="#">SkinSight</a></span>
            <i class="bx bx-x siderbarClose"></i>
          </div>

          <ul class="nav-links">
            <li><a href="home.html">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="profile.html">My Account</a></li>
          </ul>
        </div>

        <div class="darkLight-searchBox">
          <div class="dark-light">
            <i class="bx bx-moon moon"></i>
            <i class="bx bx-sun sun"></i>
          </div>

          <div class="searchBox">
            <div class="searchToggle">
              <i class="bx bx-x cancel"></i>
              <i class="bx bx-search search" onclick="searchFunction()"></i>
            </div>

            <div class="search-field">
              <input type="text" id="searchInput" placeholder="Search..." />
              <i class="bx bx-search"></i>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <h1>User Profile</h1>
    <div id="profile-data">
      <table>
        <tr>
          <th>Email</th>
          <td id="email"></td>
        </tr>
        <tr>
          <th>Username</th>
          <td id="username"></td>
        </tr>
      </table>
    </div>
    <h2>Bookmarks</h2>
    <table id="bookmark-list">
      <thead>
        <tr>
          <th>Disease Name</th>
          <th>Description</th>
          <th>Treatment</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <p id="no-data-message" style="display: none">
      Tidak ada data yang tersimpan.
    </p>

    <a href="/logout">Logout</a>
    <!-- Logout link -->

    <footer>
      <div class="footer-content">
        <p>&copy; 2023 SkinSight. All rights reserved.</p>
      </div>
    </footer>
    <script>
      // Menggunakan JavaScript untuk mengambil data profil pengguna dan bookmark menggunakan Fetch API
      fetch('/profile', { method: 'GET' })
        .then((response) => response.json())
        .then((data) => {
          const emailElement = document.getElementById('email');
          const usernameElement = document.getElementById('username');
          emailElement.textContent = data.email;
          usernameElement.textContent = data.username;
        })
        .catch((error) => {
          console.error('Error fetching profile data:', error);
        });

      fetch('/profile/bookmarks', { method: 'GET' })
        .then((response) => response.json())
        .then((data) => {
          const bookmarkList = document.getElementById('bookmark-list');
          const tbody = bookmarkList.querySelector('tbody');
          const noDataMessage = document.getElementById('no-data-message');

          if (data.bookmarks.length === 0) {
            noDataMessage.style.display = 'block';
          } else {
            data.bookmarks.forEach((bookmark) => {
              const row = document.createElement('tr');
              row.innerHTML = `
                <td>${bookmark.disease_name}</td>
                <td>${bookmark.description}</td>
                <td>${bookmark.treatment}</td>
              `;
              tbody.appendChild(row);
            });
          }
        })
        .catch((error) => {
          console.error('Error fetching bookmarks:', error);
        });
    </script>
  </body>
</html>
